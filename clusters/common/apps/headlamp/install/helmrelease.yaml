---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: headlamp
spec:
  interval: 1m
  chart:
    spec:
      chart: headlamp
      version: "*"
      sourceRef:
        kind: HelmRepository
        name: headlamp
        namespace: flux-system
      interval: 1m
  releaseName: headlamp
  values:
    config:
      inCluster: false

    volumeMounts:
      - name: kubeconfig
        mountPath: /kubeconfig
        readOnly: true

    volumes:
      - name: kubeconfig
        secret:
          secretName: headlamp-kubeconfig
          defaultMode: 0400

    env:
      - name: KUBECONFIG
        value: /kubeconfig/config

    # config:
    #   oidc:
    #     clientID: "05c250fc-4dc0-4f53-9381-ab0b704c918e"
    #     clientSecret: "eLHTrBgsWJZhtgWSGwmOppseSRkUDCie"
    #     issuerURL: "https://pocket-id.${CLUSTER_DOMAIN}"
    #     scopes: "openid profile email"