apiVersion: tailscale.com/v1alpha1
kind: Connector
metadata:
  name: &name ${LOCATION}-subnet-router
spec:
  replicas: 3
  proxyClass: common
  tags:
    - tag:k8s
    - tag:${LOCATION}
  hostnamePrefix: *name
  exitNode: true
  subnetRouter:
    advertiseRoutes:
      - "${LAN_CIDR}" # LAN
      - "${CLUSTER_SERVICE_CIDR}" # K8s Services
      - "${CLUSTER_POD_CIDR}" # K8s Pods
      - "${CLUSTER_LOAD_BALANCER_CIDR}" # Tailscale
      - fd7a:115c:a1e0:b1a:0:${SITE_ID}::/96 # 4via6
---
apiVersion: tailscale.com/v1alpha1
kind: Connector
metadata:
  name: &name ${LOCATION}-appconnector
spec:
  replicas: 3
  proxyClass: common
  tags:
    - tag:k8s
    - tag:${LOCATION}
  hostnamePrefix: *name
  # appConnector: 
  #   routes:
  #     - "fd7a:115c:a1e0:b1a:0:${SITE_ID}::/96"