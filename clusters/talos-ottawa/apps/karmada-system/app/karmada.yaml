---
apiVersion: operator.karmada.io/v1alpha1
kind: Karmada
metadata:
  name: karmada
  namespace: karmada-system
spec:
  crdTarball:
    httpSource:
      url: "https://github.com/karmada-io/karmada/releases/download/v1.15.0/crds.tar.gz"
  components:
    etcd:
      local:
        imageRepository: registry.k8s.io/etcd
        imageTag: 3.6.0-0
        replicas: 3
        volumeData:
          volumeClaim:
            metadata:
              name: etcd-data
            spec:
              storageClassName: ceph-block-replicated
              accessModes:
                - ReadWriteOnce
              resources:
                requests:
                  storage: 5Gi
    karmadaAPIServer:
      imageRepository: registry.k8s.io/kube-apiserver
      imageTag: v1.34.1
      replicas: 2
      serviceType: ClusterIP
      serviceSubnet: 10.96.0.0/12
      # certSANs for the Tailscale FQDN will be added to the generated certificates
      certSANs:
        - "ottawa-karmada-apiserver.keiretsu.ts.net"
        - "karmada-apiserver.karmada-system.svc.cluster.local"
        - "karmada-apiserver.karmada-system.svc"
        - "karmada-apiserver"
        - "localhost"
        - "127.0.0.1"
    karmadaAggregatedAPIServer:
      imageRepository: docker.io/karmada/karmada-aggregated-apiserver
      imageTag: v1.15.0
      replicas: 2
    karmadaControllerManager:
      imageRepository: docker.io/karmada/karmada-controller-manager
      imageTag: v1.15.0
      replicas: 2
    karmadaScheduler:
      imageRepository: docker.io/karmada/karmada-scheduler
      imageTag: v1.15.0
      replicas: 2
    karmadaWebhook:
      imageRepository: docker.io/karmada/karmada-webhook
      imageTag: v1.15.0
      replicas: 2
    kubeControllerManager:
      imageRepository: registry.k8s.io/kube-controller-manager
      imageTag: v1.34.1
      replicas: 2
    karmadaMetricsAdapter:
      imageRepository: docker.io/karmada/karmada-metrics-adapter
      imageTag: v1.15.0
      replicas: 2
  hostCluster:
    networking:
      dnsDomain: cluster.local
