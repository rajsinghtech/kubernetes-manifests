---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
helmCharts:
  - name: gateway-helm
    repo: oci://docker.io/envoyproxy
    releaseName: eg
    namespace: envoy-gateway-system
    version: v1.2.5
  - name: gateway-addons-helm
    repo: oci://docker.io/envoyproxy
    releaseName: eg-addons
    namespace: monitoring
    version: v1.2.5
    valuesInline:
      opentelemetry-collector:
        enabled: false
      grafana:
        enabled: false
      loki:
        enabled: false
      prometheus:
        enabled: false
      fluent-bit:
        enabled: false
      alloy:
        enabled: false
      tempo:
        enabled: false


resources:
  - gateway.yaml
  - envoy.yaml

patches:
  - patch: |-
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: envoy-gateway-dashboards
        labels:
          grafana_dashboard: "1"
          grafana_folder: envoy-gateway
    target:
      kind: ConfigMap
      name: grafana-dashboards